const chassisData = {
    "brands": [
        {
            "brand": "Ford",
            "chassis": [
                {
                    "model": "F250 Lariat 6.7L Diesel",
                    "part_number": "F2504X4",
                    "price": 92835,
                    "categories": {
                        "Model": [
                            {
                                "sales_code": "F2504X4",
                                "description": "F250 4X4 CREW CAB PICKUP/160",
                                "msrp": 64740
                            },
                            {
                                "description": "160 INCH WHEELBASE",
                                "msrp": 0
                            }
                        ],
                        "Exterior_Paint": [
                            {
                                "sales_code": "OXW",
                                "description": "Oxford White",
                                "background_color": "rgb(228, 226, 229)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "RCR",
                                "description": "Race Red",
                                "background_color": "rgb(220, 0, 0)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AVC",
                                "description": "Avalanche",
                                "background_color": "#ABABAB",
                                "msrp": 0
                            },
                            {
                                "sales_code": "DBM",
                                "description": "Darkened Bronze Metallic",
                                "background_color": "rgb(29, 25, 14)",
                                "msrp": 495
                            },
                            {
                                "sales_code": "ABM",
                                "description": "Agate Black Metallic",
                                "background_color": "rgb(27, 27, 29)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AMB",
                                "description": "Antimatter Blue",
                                "background_color": "rgb(5, 37, 66)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "CBG",
                                "description": "Carbonized Gray",
                                "background_color": "rgb(140, 137, 137)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "RRM",
                                "description": "Ruby Red Metallic",
                                "background_color": "rgb(159, 0, 4)",
                                "msrp": 495
                            },
                            {
                                "sales_code": "SWM",
                                "description": "Star White Metallic",
                                "background_color": "rgb(228, 228, 224)",
                                "msrp": 995
                            },
                            {
                                "sales_code": "GGM",
                                "description": "Glacier Gray Metallic Tri-Coat",
                                "background_color": "rgb(107, 118, 128)",
                                "msrp": 995
                            }
                        ],
                        "Paint/Seat/Trim": [
                            {
                                "description": "ACTIVEX 40/CONSOLE/40 SEAT",
                                "msrp": 0
                            },
                        ],
                        "Package": [
                            {
                                "description": "PREFERRED EQUIPMENT PKG.608A",
                                "msrp": 0
                            },
                            {
                                "description": "LARIAT TRIM",
                                "msrp": 0
                            },
                            {
                                "description": "BLACK APPEARANCE PACKAGE",
                                "msrp": 4295
                            },
                            {
                                "description": "FX4 OFF-ROAD PACKAGE",
                                "msrp": 495
                            },
                            {
                                "description": "LARIAT ULTIMATE PACKAGE",
                                "msrp": 5075
                            }
                        ],
                        "Options": [
                            {
                                "description": "6.7 HI OUTPUT POWER STROKE",
                                "msrp": 12995
                            },
                            {
                                "description": "10-SPEED AUTO TORQSHIFT",
                                "msrp": 0
                            },
                            {
                                "description": "3.31 ELECTRONIC-LOCKING AXLE",
                                "msrp": 430
                            },
                            {
                                "description": "JOB #1 ORDER",
                                "msrp": 0
                            },
                            {
                                "description": "FORD FLEET SPECIAL ADJUSTMENT",
                                "msrp": 0
                            },
                            {
                                "description": "FRONT LICENSE PLATE BRACKET",
                                "msrp": 0
                            },
                            {
                                "description": "LT275/65R20E BSW ALL-TERRAIN",
                                "msrp": 0
                            },
                            {
                                "description": "WHEEL WELL LINERS - REAR",
                                "msrp": 0
                            },
                            {
                                "description": "HI GLOSS BLACK ALUM WHEELS-20",
                                "msrp": 0
                            },
                            {
                                "description": "TOUGH BED SPRAY IN BEDLINER",
                                "msrp": 0
                            },
                            {
                                "description": "SKID PLATES",
                                "msrp": 0
                            },
                            {
                                "description": "VEHICLE INTEGRATION SYSTEM 2.0",
                                "msrp": 400
                            },
                            {
                                "description": "11100# GVWR PACKAGE",
                                "msrp": 0
                            },
                            {
                                "description": "ENGINE BLOCK HEATER",
                                "msrp": 190
                            },
                            {
                                "description": "50 STATE EMISSIONS",
                                "msrp": 0
                            },
                            {
                                "description": "HIGH CAPACITY TRAILER TOW PKG",
                                "msrp": 0
                            },
                            {
                                "description": "JACK",
                                "msrp": 0
                            },
                            {
                                "description": "MOONROOF POWER-TWIN PANEL",
                                "msrp": 1495
                            },
                            {
                                "description": "UPFITTER SWITCHES",
                                "msrp": 165
                            },
                            {
                                "description": "410 AMP DUAL ALTERNATOR",
                                "msrp": 115
                            },
                            {
                                "description": "DUAL BATTERY",
                                "msrp": 0
                            },
                            {
                                "description": "POWER SLIDING REAR WINDOW",
                                "msrp": 0
                            },
                            {
                                "description": "TAILGATE STEP",
                                "msrp": 0
                            },
                            {
                                "description": "B&O SOUND SYSTEM",
                                "msrp": 0
                            },
                            {
                                "description": "REAR PARKING SENSORS",
                                "msrp": 0
                            }
                        ],
                        "Destination Fees": [
                            {
                                "description": "SPECIAL DEALER ACCOUNT ADJUSTM",
                                "msrp": 0
                            },
                            {
                                "description": "FUEL CHARGE",
                                "msrp": 0
                            },
                            {
                                "description": "PRICED DORA",
                                "msrp": 0
                            },
                            {
                                "description": "ADVERTISING ASSESSMENT",
                                "msrp": 0
                            },
                            {
                                "description": "DESTINATION & DELIVERY",
                                "msrp": 1995
                            }
                        ]
                    },
                    "summary": {
                        "total_base_and_options": 93385,
                        "discounts": "LART ULT BLCK PKG DIST -550",
                        "total_msrp": 92835
                    }
                },
                {
                    "model": "F250 Lariat 7.3L Gas",
                    "part_number": "F2504X4V2",
                    "price": 80055,
                    "categories": {
                        "Model": [
                            {
                                "sales_code": "F2504X4V2",
                                "description": "F250 4X4 CREW CAB PICKUP/160",
                                "msrp": 64740
                            },
                            {
                                "description": "160 INCH WHEELBASE",
                                "msrp": 0
                            }
                        ],
                        "Exterior_Paint": [
                            {
                                "sales_code": "OXW",
                                "description": "Oxford White",
                                "background_color": "rgb(228, 226, 229)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "RCR",
                                "description": "Race Red",
                                "background_color": "rgb(220, 0, 0)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AVC",
                                "description": "Avalanche",
                                "background_color": "#ABABAB",
                                "msrp": 0
                            },
                            {
                                "sales_code": "DBM",
                                "description": "Darkened Bronze Metallic",
                                "background_color": "rgb(29, 25, 14)",
                                "msrp": 495
                            },
                            {
                                "sales_code": "ABM",
                                "description": "Agate Black Metallic",
                                "background_color": "rgb(27, 27, 29)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AMB",
                                "description": "Antimatter Blue",
                                "background_color": "rgb(5, 37, 66)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "CBG",
                                "description": "Carbonized Gray",
                                "background_color": "rgb(140, 137, 137)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "RRM",
                                "description": "Ruby Red Metallic",
                                "background_color": "rgb(159, 0, 4)",
                                "msrp": 495
                            },
                            {
                                "sales_code": "SWM",
                                "description": "Star White Metallic",
                                "background_color": "rgb(228, 228, 224)",
                                "msrp": 995
                            },
                            {
                                "sales_code": "GGM",
                                "description": "Glacier Gray Metallic Tri-Coat",
                                "background_color": "rgb(107, 118, 128)",
                                "msrp": 995
                            }
                        ],
                        "Paint/Seat/Trim": [
                            {
                                "description": "ACTIVEX 40/CONSOLE/40 SEAT",
                                "msrp": 0
                            },
                        ],
                        "Package": [
                            {
                                "description": "PREFERRED EQUIPMENT PKG.608A",
                                "msrp": 0
                            },
                            {
                                "description": "LARIAT TRIM",
                                "msrp": 0
                            },
                            {
                                "description": "BLACK APPEARANCE PACKAGE",
                                "msrp": 4295
                            },
                            {
                                "description": "FX4 OFF-ROAD PACKAGE",
                                "msrp": 495
                            },
                            {
                                "description": "LARIAT ULTIMATE PACKAGE",
                                "msrp": 5075
                            }
                        ],
                        "Options": [
                            {
                                "description": "7.3L DEVCT NA PFI V8 ENGINE",
                                "msrp": 1000
                            },
                            {
                                "description": "10-SPEED AUTO TORQSHIFT-G",
                                "msrp": 0
                            },
                            {
                                "description": "4.30 ELECTRONIC-LOCKING AXLE",
                                "msrp": 430
                            },
                            {
                                "description": "JOB #1 ORDER",
                                "msrp": 0
                            },
                            {
                                "description": "FORD FLEET SPECIAL ADJUSTMENT",
                                "msrp": 0
                            },
                            {
                                "description": "FRONT LICENSE PLATE BRACKET",
                                "msrp": 0
                            },
                            {
                                "description": "LT275/65R20E BSW ALL-TERRAIN",
                                "msrp": 0
                            },
                            {
                                "description": "WHEEL WELL LINERS - REAR",
                                "msrp": 0
                            },
                            {
                                "description": "HI GLOSS BLACK ALUM WHEELS-20",
                                "msrp": 0
                            },
                            {
                                "description": "TOUGH BED SPRAY IN BEDLINER",
                                "msrp": 0
                            },
                            {
                                "description": "SKID PLATES",
                                "msrp": 0
                            },
                            {
                                "description": "VEHICLE INTEGRATION SYSTEM 2.0",
                                "msrp": 400
                            },
                            {
                                "description": "10500# GVWR PACKAGE",
                                "msrp": 0
                            },
                            {
                                "description": "ENGINE BLOCK HEATER",
                                "msrp": 190
                            },
                            {
                                "description": "50 STATE EMISSIONS",
                                "msrp": 0
                            },
                            {
                                "description": "JACK",
                                "msrp": 0
                            },
                            {
                                "description": "MOONROOF POWER-TWIN PANEL",
                                "msrp": 1495
                            },
                            {
                                "description": "UPFITTER SWITCHES",
                                "msrp": 165
                            },
                            {
                                "description": "410 AMP ALTERNATOR",
                                "msrp": 115
                            },
                            {
                                "description": "DUAL BATTERY",
                                "msrp": 210
                            },
                            {
                                "description": "POWER SLIDING REAR WINDOW",
                                "msrp": 0
                            },
                            {
                                "description": "TAILGATE STEP",
                                "msrp": 0
                            },
                            {
                                "description": "B&O SOUND SYSTEM",
                                "msrp": 0
                            },
                            {
                                "description": "REAR PARKING SENSORS",
                                "msrp": 0
                            }
                        ],
                        "Destination Fees": [
                            {
                                "description": "SPECIAL DEALER ACCOUNT ADJUSTM",
                                "msrp": 0
                            },
                            {
                                "description": "FUEL CHARGE",
                                "msrp": 0
                            },
                            {
                                "description": "PRICED DORA",
                                "msrp": 0
                            },
                            {
                                "description": "ADVERTISING ASSESSMENT",
                                "msrp": 0
                            },
                            {
                                "description": "DESTINATION & DELIVERY",
                                "msrp": 1995
                            }
                        ]
                    },
                    "summary": {
                        "total_base_and_options": 80605,
                        "discounts": "LART ULT BLCK PKG DIST -550",
                        "total_msrp": 80055
                    }

                },
                {
                    "model": "F250 XLT 6.7L Diesel",
                    "part_number": "F2504X4V3",
                    "price": 84910,
                    "categories": {
                        "Model": [
                            {
                                "sales_code": "F2504X4V3",
                                "description": "F250 4X4 CREW CAB PICKUP/160",
                                "msrp": 55700
                            },
                            {
                                "description": "160 INCH WHEELBASE",
                                "msrp": 0
                            }
                        ],
                        "Exterior_Paint": [
                            {
                                "sales_code": "OXW",
                                "description": "Oxford White",
                                "background_color": "rgb(228, 226, 229)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "RCR",
                                "description": "Race Red",
                                "background_color": "rgb(220, 0, 0)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AVC",
                                "description": "Avalanche",
                                "background_color": "#ABABAB",
                                "msrp": 0
                            },
                            {
                                "sales_code": "DBM",
                                "description": "Darkened Bronze Metallic",
                                "background_color": "rgb(29, 25, 14)",
                                "msrp": 495
                            },
                            {
                                "sales_code": "ABM",
                                "description": "Agate Black Metallic",
                                "background_color": "rgb(27, 27, 29)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AMB",
                                "description": "Antimatter Blue",
                                "background_color": "rgb(5, 37, 66)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "CBG",
                                "description": "Carbonized Gray",
                                "background_color": "rgb(140, 137, 137)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "RRM",
                                "description": "Ruby Red Metallic",
                                "background_color": "rgb(159, 0, 4)",
                                "msrp": 495
                            },
                            {
                                "sales_code": "SWM",
                                "description": "Star White Metallic",
                                "background_color": "rgb(228, 228, 224)",
                                "msrp": 995
                            },
                            {
                                "sales_code": "GGM",
                                "description": "Glacier Gray Metallic Tri-Coat",
                                "background_color": "rgb(107, 118, 128)",
                                "msrp": 995
                            }
                        ],
                        "Paint/Seat/Trim": [
                            {
                                "description": "CLOTH 40/CONSOLE/40 SEAT",
                                "msrp": 300
                            },
                            {
                                "description": "MEDIUM DARK SLATE",
                                "msrp": 0
                            }
                        ],
                        "Package": [
                            {
                                "description": "PREFERRED EQUIPMENT PKG.603A",
                                "msrp": 0
                            },
                            {
                                "description": "XLT TRIM",
                                "msrp": 0
                            },
                            {
                                "description": "BLACK APPEARANCE PACKAGE",
                                "msrp": 4795
                            },
                            {
                                "description": "XLT PREMIUM PACKAGE",
                                "msrp": 4150
                            }
                        ],
                        "Options": [
                            {
                                "description": "6.7 HI OUTPUT POWER STROKE",
                                "msrp": 12995
                            },
                            {
                                "description": "10-SPEED AUTO TORQSHIFT",
                                "msrp": 0
                            },
                            {
                                "description": "3.55 ELECTRONIC-LOCKING AXLE",
                                "msrp": 430
                            },
                            {
                                "description": "JOB #1 ORDER",
                                "msrp": 0
                            },
                            {
                                "description": "FORD FLEET SPECIAL ADJUSTMENT",
                                "msrp": 0
                            },
                            {
                                "description": "FRONT LICENSE PLATE BRACKET",
                                "msrp": 0
                            },
                            {
                                "description": "ALL WEATHER MATS W/O CARPT MAT",
                                "msrp": 130
                            },
                            {
                                "description": "LT275/65R20E BSW ALL-TERRAIN",
                                "msrp": 0
                            },
                            {
                                "description": "WHEEL WELL LINERS - REAR",
                                "msrp": 0
                            },
                            {
                                "description": "HI GLOSS BLACK ALUM WHEELS-20",
                                "msrp": 0
                            },
                            {
                                "description": "LED BOX LIGHTING",
                                "msrp": 0
                            },
                            {
                                "description": "TOUGH BED SPRAY IN BEDLINER",
                                "msrp": 0
                            },
                            {
                                "description": "SIRIUSXM W/360L- NA AK&HI",
                                "msrp": 0
                            },
                            {
                                "description": "POWERSCOPE TRAILER TOW MIRROR",
                                "msrp": 0
                            },
                            {
                                "description": "B&O SOUND SYSTEM",
                                "msrp": 0
                            },
                            {
                                "description": "BLIS (BLIND SPOT INFO SYSTEM)",
                                "msrp": 0
                            },
                            {
                                "description": "REAR PARKING SENSORS",
                                "msrp": 0
                            },
                            {
                                "description": "REMOTE START SYSTEM",
                                "msrp": 0
                            },
                            {
                                "description": "360-DEGREE CAMERA PACKAGE",
                                "msrp": 0
                            },
                            {
                                "description": "HEATED FRONT SEATS",
                                "msrp": 0
                            },
                            {
                                "description": "11100# GVWR PACKAGE",
                                "msrp": 0
                            },
                            {
                                "description": "RAPID HEAT SUPPLEMENTAL HEATER",
                                "msrp": 250
                            },
                            {
                                "description": "ENGINE BLOCK HEATER",
                                "msrp": 190
                            },
                            {
                                "description": "50 STATE EMISSIONS",
                                "msrp": 0
                            },
                            {
                                "description": "BACKGLASS DEFROST",
                                "msrp": 0
                            },
                            {
                                "description": "PRO POWER ONBOARD - 2KW",
                                "msrp": 985
                            },
                            {
                                "description": "POWER SLIDING REAR WINDOW",
                                "msrp": 405
                            },
                            {
                                "description": "SPARE TIRE AND WHEEL",
                                "msrp": 0
                            },
                            {
                                "description": "5TH WHEEL HITCH PREP PACKAGE",
                                "msrp": 550
                            },
                            {
                                "description": "HIGH CAPACITY TRAILER TOW PKG",
                                "msrp": 0
                            },
                            {
                                "description": "PAYLOAD PACKAGE UPGRADE",
                                "msrp": 0
                            },
                            {
                                "description": "JACK",
                                "msrp": 0
                            },
                            {
                                "description": "MOONROOF POWER-TWIN PANEL",
                                "msrp": 1495
                            },
                            {
                                "description": "UPFITTER SWITCHES",
                                "msrp": 165
                            },
                            {
                                "description": "TAILGATE STEP",
                                "msrp": 375
                            },
                            {
                                "description": "DUAL BATTERY",
                                "msrp": 0
                            }
                        ],
                        "Destination Fees": [
                            {
                                "description": "SPECIAL DEALER ACCOUNT ADJUSTM",
                                "msrp": 0
                            },
                            {
                                "description": "FUEL CHARGE",
                                "msrp": 0
                            },
                            {
                                "description": "PRICED DORA",
                                "msrp": 0
                            },
                            {
                                "description": "ADVERTISING ASSESSMENT",
                                "msrp": 0
                            },
                            {
                                "description": "DESTINATION & DELIVERY",
                                "msrp": 1995
                            }
                        ]
                    },
                    "summary": {
                        "total_base_and_options": 84910,
                        "discounts": "N/A",
                        "total_msrp": 84910
                    }
                }
            ],
        },
        {
            "brand": "Ram",
            "chassis": [
                {
                    "model": "2025 2500 BIG HORN CREW CAB 6.4L V8",
                    "part_number": "DJ7H91",
                    "price": 73330,
                    "categories": {
                        "Model": [
                            {
                                "sales_code": "DJ7H91",
                                "description": "2500 BIG HORN CREW CAB 4X4 (149 in WB 6 ft 4 in Box)",
                                "msrp": 58730
                            }
                        ],
                        "Exterior_Paint": [
                            {
                                "sales_code": "CGC",
                                "description": "Ceramic Gray Clear-Coat",
                                "msrp": 0,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Ceramic_Gray_Clear-Coat.jpg"

                            },
                            {
                                "sales_code": "PW7",
                                "description": "Bright White Clear-Coat",
                                "msrp": 0,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/07/brightWhite_clearVoat.webp"
                            },
                            {
                                "sales_code": "DBC",
                                "description": "Diamond Black Crystal Pearl-Coat",
                                "msrp": 0,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Diamond_Black_Crystal_Pearl-Coat.jpg"
                            },
                            {
                                "sales_code": "MRP",
                                "description": "Molten Red Pearl-Coat",
                                "msrp": 245,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Molten_Red_Pearl-Coat.jpg"
                            },
                            {
                                "sales_code": "FBM",
                                "description": "Forged Blue Metallic",
                                "msrp": 295,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Forged_Blue_Metallic.avif"
                            },
                            {
                                "sales_code": "SZH",
                                "description": "Silver-Zynith",
                                "msrp": 295,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Silver-Zynith.jpg"
                            },
                            {
                                "sales_code": "PAU",
                                "description": "Granite Crystal Metallic Clear-Coat",
                                "msrp": 295,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/07/granite_crystal_metallic.webp"
                            }
                        ],
                        "Paint/Seat/Trim": [
                            {
                                "sales_code": "APA",
                                "description": "Monotone Paint",
                                "msrp": 0
                            },
                            {
                                "sales_code": "*MJ",
                                "description": "Premium Cloth Bucket Seats",
                                "msrp": 295
                            },
                            {
                                "sales_code": "-X9",
                                "description": "Black",
                                "msrp": 0
                            }
                        ],
                        "Package": [
                            {
                                "sales_code": "2GZ",
                                "description": "Customer Preferred Package 2GZ",
                                "msrp": 0
                            },
                            {
                                "sales_code": "ESB",
                                "description": "6.4L V8 Heavy Duty HEMI MDS Engine",
                                "msrp": 0
                            },
                            {
                                "sales_code": "DFX",
                                "description": "8-Spd Auto 8HP75-LCV Transmission",
                                "msrp": 0
                            },
                            {
                                "sales_code": "A63",
                                "description": "Level 2 Equipment Group",
                                "msrp": 5110
                            },
                            {
                                "sales_code": "ASH",
                                "description": "Night Edition",
                                "msrp": 3145
                            },
                            {
                                "sales_code": "ARC",
                                "description": "Off Road Package",
                                "msrp": 495
                            },
                            {
                                "sales_code": "ANT",
                                "description": "Bed Utility Group",
                                "msrp": 845
                            },
                            {
                                "sales_code": "AHD",
                                "description": "Heavy Duty Snow Plow Prep Group",
                                "msrp": 195
                            }
                        ],
                        "Options": [
                            {
                                "sales_code": "MWH",
                                "description": "Rear Wheelhouse Liners",
                                "msrp": 195
                            },
                            {
                                "sales_code": "LHL",
                                "description": "Auxiliary Switches - I/P Mounted",
                                "msrp": 145
                            },
                            {
                                "sales_code": "DSA",
                                "description": "Anti-Spin Differential Rear Axle",
                                "msrp": 495
                            },
                            {
                                "sales_code": "RC3",
                                "description": "9 Alpine Speakers w/Subwoofer",
                                "msrp": 595
                            },
                            {
                                "sales_code": "AD6",
                                "description": "Premium Lighting Group",
                                "msrp": 795
                            },
                            {
                                "sales_code": "NAS",
                                "description": "50 State Emissions",
                                "msrp": 0
                            },
                            {
                                "sales_code": "4UQ",
                                "description": "T3AC",
                                "msrp": 0
                            },
                            {
                                "sales_code": "4NU",
                                "description": "Fuel Fill / Battery Charge",
                                "msrp": 0
                            },
                            {
                                "sales_code": "YG2",
                                "description": "5.2 Additional Gallons of Gas",
                                "msrp": 0
                            },
                            {
                                "sales_code": "5N7",
                                "description": "Saved Favorites",
                                "msrp": 0
                            },
                            {
                                "sales_code": "4FM",
                                "description": "Fleet Option Editor",
                                "msrp": 0
                            },
                            {
                                "sales_code": "4DN",
                                "description": "Recreational Vehicle Tracking",
                                "msrp": 0
                            },
                            {
                                "sales_code": "99587B",
                                "description": "Special Equipment 99587B",
                                "msrp": 0
                            },
                            {
                                "sales_code": "99587A",
                                "description": "Special Equipment 99587A",
                                "msrp": 0
                            }
                        ],
                        "Destination Fees": [
                            {
                                "description": "Destination & Delivery",
                                "msrp": 1995
                            }
                        ]
                    },
                    "summary": {
                        "total_base_and_options": 73330,
                        "discounts": "N/A",
                        "total_msrp": 73330
                    }
                },
                {
                    "model": "2025 2500 LARAMIE CREW CAB 4X4 6.7L Turbo Diesel",
                    "part_number": "DJ7P91",
                    "price": 83420,
                    "categories": {
                        "Model": [
                            {
                                "sales_code": "DJ7P91",
                                "description": "2500 LARAMIE CREW CAB 4X4 (149 in WB 6 ft 4 in Box)",
                                "msrp": 63805
                            }
                        ],
                        "Exterior_Paint": [
                            {
                                "sales_code": "CGC",
                                "description": "Ceramic Gray Clear-Coat",
                                "msrp": 0,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Ceramic_Gray_Clear-Coat.jpg"

                            },
                            {
                                "sales_code": "PW7",
                                "description": "Bright White Clear-Coat",
                                "msrp": 0,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/07/brightWhite_clearVoat.webp"
                            },
                            {
                                "sales_code": "DBC",
                                "description": "Diamond Black Crystal Pearl-Coat",
                                "msrp": 0,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Diamond_Black_Crystal_Pearl-Coat.jpg"
                            },
                            {
                                "sales_code": "MRP",
                                "description": "Molten Red Pearl-Coat",
                                "msrp": 245,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Molten_Red_Pearl-Coat.jpg"
                            },
                            {
                                "sales_code": "FBM",
                                "description": "Forged Blue Metallic",
                                "msrp": 295,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Forged_Blue_Metallic.avif"
                            },
                            {
                                "sales_code": "SZH",
                                "description": "Silver-Zynith",
                                "msrp": 295,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/08/Silver-Zynith.jpg"
                            },
                            {
                                "sales_code": "PAU",
                                "description": "Granite Crystal Metallic Clear-Coat",
                                "msrp": 295,
                                "image": "https://www.waldoch.com/wp-content/uploads//2025/07/granite_crystal_metallic.webp"
                            }
                        ],
                        "Paint/Seat/Trim": [
                            {
                                "sales_code": "APA",
                                "description": "Monotone Paint",
                                "msrp": 0
                            },
                            {
                                "sales_code": "*GJ",
                                "description": "Leather Trimmed Bucket Seats",
                                "msrp": 545
                            },
                            {
                                "sales_code": "-X9",
                                "description": "Black",
                                "msrp": 0
                            }
                        ],
                        "Package": [
                            {
                                "sales_code": "2HH",
                                "description": "Customer Preferred Package 2HH",
                                "msrp": 0
                            },
                            {
                                "sales_code": "ETL",
                                "description": "6.7L I6 Cummins Turbo Diesel Engine",
                                "msrp": 9795
                            },
                            {
                                "sales_code": "DG7",
                                "description": "6-Spd Automatic 68RFE Transmission",
                                "msrp": 0
                            },
                            {
                                "sales_code": "A77",
                                "description": "Laramie Level B Equipment Group",
                                "msrp": 2160
                            },
                            {
                                "sales_code": "ARC",
                                "description": "Off Road Package",
                                "msrp": 445
                            },
                            {
                                "sales_code": "ANT",
                                "description": "Bed Utility Group",
                                "msrp": 845
                            },
                            {
                                "sales_code": "AHD",
                                "description": "Heavy Duty Snow Plow Prep Group",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AEF",
                                "description": "Sport Appearance Package",
                                "msrp": 3095
                            }
                        ],
                        "Options": [
                            {
                                "sales_code": "NAS",
                                "description": "50 State Emissions",
                                "msrp": 0
                            },
                            {
                                "sales_code": "LNC",
                                "description": "Clearance Lamps",
                                "msrp": 95
                            },
                            {
                                "sales_code": "LHL",
                                "description": "Auxiliary Switches - I/P Mounted",
                                "msrp": 145
                            },
                            {
                                "sales_code": "DSA",
                                "description": "Anti-Spin Differential Rear Axle",
                                "msrp": 495
                            },
                            {
                                "sales_code": "YEP",
                                "description": "Manuf Statement of Origin",
                                "msrp": 0
                            },
                            {
                                "sales_code": "4UQ",
                                "description": "T3AC",
                                "msrp": 0
                            },
                            {
                                "sales_code": "4NU",
                                "description": "Fuel Fill / Battery Charge",
                                "msrp": 0
                            },
                            {
                                "sales_code": "YG4",
                                "description": "5.5 Additional Gallons of Diesel",
                                "msrp": 0
                            },
                            {
                                "sales_code": "5N7",
                                "description": "Saved Favorites",
                                "msrp": 0
                            },
                            {
                                "sales_code": "4FM",
                                "description": "Fleet Option Editor",
                                "msrp": 0
                            },
                            {
                                "sales_code": "4DN",
                                "description": "Recreational Vehicle Tracking",
                                "msrp": 0
                            },
                            {
                                "sales_code": "99587B",
                                "description": "Special Equipment 99587B",
                                "msrp": 0
                            },
                            {
                                "sales_code": "99587A",
                                "description": "Special Equipment 99587A",
                                "msrp": 0
                            }
                        ],
                        "Destination Fees": [
                            {
                                "description": "Destination & Delivery",
                                "msrp": 1995
                            }
                        ]
                    },
                    "summary": {
                        "total_base_and_options": 83420,
                        "discounts": "N/A",
                        "total_msrp": 83420
                    }
                }
            ],
        },
        {
            "brand": "Chevrolet",
            "chassis": [
                {
                    "model": "2025 2500HD Silverado LT 4WD Standard Box Crew Cab 6.6L DuraMax Turbo Diesel",
                    "part_number": "CK20743",
                    "price": 75360,
                    "categories": {
                        "Model": [
                            {
                                "sales_code": "CK20743",
                                "description": "2500HD Silverado 4WD Standard Box Crew Cab",
                                "msrp": 75360
                            }
                        ],
                        "Exterior_Paint": [
                            {
                                "sales_code": "GXP",
                                "description": "Lakeshsore Blue Metallic",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GXP.jpg",
                                "msrp": 0
                            },
                            {
                                "sales_code": "GXD",
                                "description": "Sterling Gray Metallic",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GXD.jpg",
                                "msrp": 0
                            },
                            {
                                "sales_code": "GAZ",
                                "description": "Summit White",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GAZ.jpg",
                                "msrp": 200
                            },
                            {
                                "sales_code": "GBA",
                                "description": "Black",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GBA.jpg",
                                "msrp": 200
                            },
                            {
                                "sales_code": "GNT",
                                "description": "Radiant Red Tintcoat",
                                "image": "http://chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GNT.jpg",
                                "msrp": 495
                            },
                            {
                                "sales_code": "G1W",
                                "description": "Iridescent Pearl Tricoat",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/G1W.jpg",
                                "msrp": 995
                            },
                        ],
                        "Paint/Seat/Trim": [
                            {
                                "sales_code": "H0U",
                                "description": "1WT/1LT/1SP/2LT/1FL/1LS-Cloth, Jet Black, Interior Trim",
                                "msrp": 0
                            }
                        ],
                        "Package": [
                            {
                                "sales_code": "1LT",
                                "description": "LT Preferred Equipment Group",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PCL",
                                "description": "1LT/1SP/2LT Convenience 1 Package",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PCM",
                                "description": "1LT/1SP/2LT Convenience 2 Package",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PDU",
                                "description": "1LT/1SP All-Star Edition",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PQB",
                                "description": "Safety Package",
                                "msrp": 0
                            },
                            {
                                "sales_code": "WBL",
                                "description": "Z71 Chrome Sport Edition",
                                "msrp": 0
                            },
                            {
                                "sales_code": "Z71",
                                "description": "Suspension Package: Off-Road",
                                "msrp": 0
                            },
                            {
                                "sales_code": "Z82",
                                "description": "Trailering Package",
                                "msrp": 0
                            },
                            {
                                "sales_code": "ZM9",
                                "description": "1LT Heat Package",
                                "msrp": 0
                            }
                        ],
                        "Options": [
                            {
                                "sales_code": "L5P",
                                "description": "Engine: 6.6L V8 DuraMax Diesel, Turbo",
                                "msrp": 0
                            },
                            {
                                "sales_code": "MGM",
                                "description": "10-Speed Automatic",
                                "msrp": 0
                            },
                            {
                                "sales_code": "NE1",
                                "description": "CT/MA/MD/ME/NJ/NY/OR/PA/RI/VT/WA Emissions",
                                "msrp": 0
                            },
                            {
                                "sales_code": "5K9",
                                "description": "Wheels: 20\" Polished Aluminum",
                                "msrp": 0
                            },
                            {
                                "sales_code": "A2X",
                                "description": "Power Seat Adjuster (Driver's Side)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "A48",
                                "description": "Window, Power Rear Sliding",
                                "msrp": 0
                            },
                            {
                                "sales_code": "A50",
                                "description": "Seats: Front, Bucket, Full Feature",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AKO",
                                "description": "Glass, Deep Tinted",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AVJ",
                                "description": "Keyless Open & Keyless Start",
                                "msrp": 0
                            },
                            {
                                "sales_code": "B1J",
                                "description": "Liner, Rear Wheelhouse",
                                "msrp": 0
                            },
                            {
                                "sales_code": "B30",
                                "description": "Floor Covering: Carpet, Color Keyed",
                                "msrp": 0
                            },
                            {
                                "sales_code": "B3P",
                                "description": "Special Vehicle Sales",
                                "msrp": 0
                            },
                            {
                                "sales_code": "B59",
                                "description": "Remote Start Package",
                                "msrp": 0
                            },
                            {
                                "sales_code": "BHP",
                                "description": "Diesel Engine Winter Cover",
                                "msrp": 0
                            },
                            {
                                "sales_code": "BTV",
                                "description": "Remote Engine Starting Pkg",
                                "msrp": 0
                            },
                            {
                                "sales_code": "C49",
                                "description": "Defogger, Rear Window, Electric",
                                "msrp": 0
                            },
                            {
                                "sales_code": "CGN",
                                "description": "Chevytec Spray-on Liner",
                                "msrp": 0
                            },
                            {
                                "sales_code": "CJ2",
                                "description": "Climate Control, Electronic - Multi-zone",
                                "msrp": 0
                            },
                            {
                                "sales_code": "D07",
                                "description": "Center Floor Console, fixed",
                                "msrp": 0
                            },
                            {
                                "sales_code": "DD8",
                                "description": "ISRV Mirror, Electro-chromatic",
                                "msrp": 0
                            },
                            {
                                "sales_code": "DWI",
                                "description": "Mirrors, O/S: Pwr Fold., Man. Ext., Heat, Turn Indicator",
                                "msrp": 0
                            },
                            {
                                "sales_code": "E63",
                                "description": "Durabed",
                                "msrp": 0
                            },
                            {
                                "sales_code": "G80",
                                "description": "Auto Locking Differential, Rear",
                                "msrp": 0
                            },
                            {
                                "sales_code": "GU6",
                                "description": "Rear Axle: 3.42 Ratio",
                                "msrp": 0
                            },
                            {
                                "sales_code": "IOK",
                                "description": "Chevrolet Infotainment, Enhanced connectivity 2.0",
                                "msrp": 0
                            },
                            {
                                "sales_code": "JFP",
                                "description": "GVW Rating 11,300 Lbs",
                                "msrp": 0
                            },
                            {
                                "sales_code": "JHD",
                                "description": "Hill Descent Control",
                                "msrp": 0
                            },
                            {
                                "sales_code": "JL1",
                                "description": "Integrated Trailer Brake Controller",
                                "msrp": 0
                            },
                            {
                                "sales_code": "K05",
                                "description": "Engine Block Heater",
                                "msrp": 0
                            },
                            {
                                "sales_code": "K40",
                                "description": "Diesel Engine Exhaust Brake",
                                "msrp": 0
                            },
                            {
                                "sales_code": "K47",
                                "description": "Heavy Duty Air Filter",
                                "msrp": 0
                            },
                            {
                                "sales_code": "K4C",
                                "description": "Wireless Charging",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KA1",
                                "description": "Heated Seats, Front",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KC4",
                                "description": "Cooler, Engine Oil",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KI3",
                                "description": "Heated Steering Wheel",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KI4",
                                "description": "120 Volt Electrical Receptacle, In Cab",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KNP",
                                "description": "Transmission Cooling System",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KSG",
                                "description": "Adaptive Cruise Control",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KW5",
                                "description": "Alternator, 220 AMP",
                                "msrp": 0
                            },
                            {
                                "sales_code": "N37",
                                "description": "Steering Column, Manual Tilt & Telescoping",
                                "msrp": 0
                            },
                            {
                                "sales_code": "NQF",
                                "description": "Transfer Case: w/ Rotary Dial Control, Electronic Shift",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PZ8",
                                "description": "Hitch Guidance with Hitch View and Image Adjustment",
                                "msrp": 0
                            },
                            {
                                "sales_code": "QF9",
                                "description": "Tires: LT275/65 R20 All Terrain, Blackwall",
                                "msrp": 0
                            },
                            {
                                "sales_code": "QK1",
                                "description": "Standard Tailgate",
                                "msrp": 0
                            },
                            {
                                "sales_code": "QT6",
                                "description": "Tailgate Function--Power Up and Down",
                                "msrp": 0
                            },
                            {
                                "sales_code": "R7O",
                                "description": "Rear Seat: Folding with Storage Package",
                                "msrp": 0
                            },
                            {
                                "sales_code": "SAF",
                                "description": "Spare Tire Lock",
                                "msrp": 0
                            },
                            {
                                "sales_code": "T3U",
                                "description": "LED Fog Lamps, Front",
                                "msrp": 0
                            },
                            {
                                "sales_code": "TQ5",
                                "description": "Headlamps, Intellibeam",
                                "msrp": 0
                            },
                            {
                                "sales_code": "U01",
                                "description": "Roof Marker Lamps",
                                "msrp": 0
                            },
                            {
                                "sales_code": "U2K",
                                "description": "SiriusXM Satellite Radio (subscription)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UBC",
                                "description": "2-USBs, First Row Charge/Data Ports",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UBI",
                                "description": "2-USBs, Second Row Charge/Data Ports",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UD5",
                                "description": "Parking Assist, Front & Rear Sensors",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UE1",
                                "description": "OnStar Communication System",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UE4",
                                "description": "Following Distance Indicator",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UET",
                                "description": "Smart Trailer Indicator",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UEU",
                                "description": "Sensor, Forward Collision Alert",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UF2",
                                "description": "Lighting, Cargo Box, LED",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UG1",
                                "description": "Homelink Garage Door Opener",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UHY",
                                "description": "Automatic Emergency Braking",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UK3",
                                "description": "Radio Controls - Steering Wheel",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UKJ",
                                "description": "Sensor, Front Pedestrian Braking",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UKV",
                                "description": "Trailer Side Blind Zone Alert",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UTJ",
                                "description": "Theft Protection System, Unauthorized Entry",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UVN",
                                "description": "Bed View Camera",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UY2",
                                "description": "Wiring Provisions: Camper",
                                "msrp": 0
                            },
                            {
                                "sales_code": "V76",
                                "description": "Recovery Hooks",
                                "msrp": 0
                            },
                            {
                                "sales_code": "VK3",
                                "description": "Front License Plate Mounting Provisions",
                                "msrp": 0
                            },
                            {
                                "sales_code": "VXJ",
                                "description": "LPO - Assist Steps, 4\" Round, Tubular, Chrome",
                                "msrp": 0
                            },
                            {
                                "sales_code": "YM8",
                                "description": "LPO Processing Option",
                                "msrp": 0
                            }
                        ],
                        "Destination Fees": [
                            {
                                "description": "Destination & Delivery",
                                "msrp": 0
                            }
                        ]
                    },
                    "summary": {
                        "total_base_and_options": 75360,
                        "discounts": "N/A",
                        "total_msrp": 75360
                    }
                },
                {
                    "model": "2025 2500HD Silverado LTZ 4WD Standard Box Crew Cab 6.6L DuraMax Turbo Diesel",
                    "part_number": "CK20743_LTZ",
                    "price": 82435,
                    "categories": {
                        "Model": [
                            {
                                "sales_code": "CK20743_LTZ",
                                "description": "2500HD Silverado 4WD Standard Box Crew Cab",
                                "msrp": 82435
                            }
                        ],
                        "Exterior_Paint": [
                            {
                                "sales_code": "GXP",
                                "description": "Lakeshsore Blue Metallic",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GXP.jpg",
                                "msrp": 0
                            },
                            {
                                "sales_code": "GXD",
                                "description": "Sterling Gray Metallic",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GXD.jpg",
                                "msrp": 0
                            },
                            {
                                "sales_code": "GAZ",
                                "description": "Summit White",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GAZ.jpg",
                                "msrp": 200
                            },
                            {
                                "sales_code": "GBA",
                                "description": "Black",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GBA.jpg",
                                "msrp": 200
                            },
                            {
                                "sales_code": "GNT",
                                "description": "Radiant Red Tintcoat",
                                "image": "http://chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/GNT.jpg",
                                "msrp": 495
                            },
                            {
                                "sales_code": "G1W",
                                "description": "Iridescent Pearl Tricoat",
                                "image": "https://www.chevrolet.com/bypass/master_tools/ddp/gmna/assets/US/chevrolet/2025/silverado/silverado-2500hd/small_byo3/G1W.jpg",
                                "msrp": 995
                            },
                        ],
                        "Paint/Seat/Trim": [
                            {
                                "sales_code": "H1Y",
                                "description": "1LZ-Leather, Jet Black, Interior Trim",
                                "msrp": 0
                            }
                        ],
                        "Package": [
                            {
                                "sales_code": "1LZ",
                                "description": "LTZ Preferred Equipment Group",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PCN",
                                "description": "LTZ Convenience Package 2",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PCZ",
                                "description": "LTZ Convenience Package 1",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PDF",
                                "description": "LTZ Plus Package",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PQB",
                                "description": "Safety Package",
                                "msrp": 0
                            },
                            {
                                "sales_code": "WPK",
                                "description": "Silverado: Trail Boss Package",
                                "msrp": 0
                            },
                            {
                                "sales_code": "Z71",
                                "description": "Suspension Package: Off-Road",
                                "msrp": 0
                            },
                            {
                                "sales_code": "Z82",
                                "description": "Trailering Package",
                                "msrp": 0
                            }
                        ],
                        "Options": [
                            {
                                "sales_code": "L5P",
                                "description": "Engine: 6.6L V8 DuraMax Diesel, Turbo",
                                "msrp": 0
                            },
                            {
                                "sales_code": "MGM",
                                "description": "10-Speed Automatic",
                                "msrp": 0
                            },
                            {
                                "sales_code": "NE1",
                                "description": "CT/MA/MD/ME/NJ/NY/OR/PA/RI/VT/WA Emissions",
                                "msrp": 0
                            },
                            {
                                "sales_code": "A2X",
                                "description": "Power Seat Adjuster (Driver's Side)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "A48",
                                "description": "Window, Power Rear Sliding",
                                "msrp": 0
                            },
                            {
                                "sales_code": "A50",
                                "description": "Seats: Front, Bucket, Full Feature",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AKO",
                                "description": "Glass, Deep Tinted",
                                "msrp": 0
                            },
                            {
                                "sales_code": "AVJ",
                                "description": "Keyless Open & Keyless Start",
                                "msrp": 0
                            },
                            {
                                "sales_code": "B1J",
                                "description": "Liner, Rear Wheelhouse",
                                "msrp": 0
                            },
                            {
                                "sales_code": "B30",
                                "description": "Floor Covering: Carpet, Color Keyed",
                                "msrp": 0
                            },
                            {
                                "sales_code": "B3P",
                                "description": "Special Vehicle Sales",
                                "msrp": 0
                            },
                            {
                                "sales_code": "BHP",
                                "description": "Diesel Engine Winter Cover",
                                "msrp": 0
                            },
                            {
                                "sales_code": "BTV",
                                "description": "Remote Engine Starting Pkg",
                                "msrp": 0
                            },
                            {
                                "sales_code": "C49",
                                "description": "Defogger, Rear Window, Electric",
                                "msrp": 0
                            },
                            {
                                "sales_code": "CF5",
                                "description": "Sun Roof, Electric Sliding",
                                "msrp": 0
                            },
                            {
                                "sales_code": "CGN",
                                "description": "Chevytec Spray-on Liner",
                                "msrp": 0
                            },
                            {
                                "sales_code": "CJ2",
                                "description": "Climate Control, Electronic - Multi-zone",
                                "msrp": 0
                            },
                            {
                                "sales_code": "D07",
                                "description": "Center Floor Console, fixed",
                                "msrp": 0
                            },
                            {
                                "sales_code": "DD8",
                                "description": "ISRV Mirror, Electro-chromatic",
                                "msrp": 0
                            },
                            {
                                "sales_code": "DP6",
                                "description": "Mirrors, Outside, Body Color Cap",
                                "msrp": 0
                            },
                            {
                                "sales_code": "DZC",
                                "description": "Mirrors, O/S: Pwr Fold & Extend, Heat, Turn Indicator",
                                "msrp": 0
                            },
                            {
                                "sales_code": "E63",
                                "description": "Durabed",
                                "msrp": 0
                            },
                            {
                                "sales_code": "G80",
                                "description": "Auto Locking Differential, Rear",
                                "msrp": 0
                            },
                            {
                                "sales_code": "GU6",
                                "description": "Rear Axle: 3.42 Ratio",
                                "msrp": 0
                            },
                            {
                                "sales_code": "IOK",
                                "description": "Chevrolet Infotainment, Enhanced connectivity 2.0",
                                "msrp": 0
                            },
                            {
                                "sales_code": "JFP",
                                "description": "GVW Rating 11,300 Lbs",
                                "msrp": 0
                            },
                            {
                                "sales_code": "JHD",
                                "description": "Hill Descent Control",
                                "msrp": 0
                            },
                            {
                                "sales_code": "JL1",
                                "description": "Integrated Trailer Brake Controller",
                                "msrp": 0
                            },
                            {
                                "sales_code": "K05",
                                "description": "Engine Block Heater",
                                "msrp": 0
                            },
                            {
                                "sales_code": "K40",
                                "description": "Diesel Engine Exhaust Brake",
                                "msrp": 0
                            },
                            {
                                "sales_code": "K47",
                                "description": "Heavy Duty Air Filter",
                                "msrp": 0
                            },
                            {
                                "sales_code": "K4C",
                                "description": "Wireless Charging",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KA1",
                                "description": "Heated Seats, Front",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KA6",
                                "description": "Heated Seats: 2nd Row",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KC4",
                                "description": "Cooler, Engine Oil",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KI3",
                                "description": "Heated Steering Wheel",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KI4",
                                "description": "120 Volt Electrical Receptacle, In Cab",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KNP",
                                "description": "Transmission Cooling System",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KQV",
                                "description": "Seats, Heated & Ventilated, Front",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KSG",
                                "description": "Adaptive Cruise Control",
                                "msrp": 0
                            },
                            {
                                "sales_code": "KW5",
                                "description": "Alternator, 220 AMP",
                                "msrp": 0
                            },
                            {
                                "sales_code": "N37",
                                "description": "Steering Column, Manual Tilt & Telescoping",
                                "msrp": 0
                            },
                            {
                                "sales_code": "NQH",
                                "description": "Transfer Case: Active, 2-Speed, Autotrac, Rotary Dial",
                                "msrp": 0
                            },
                            {
                                "sales_code": "PZ8",
                                "description": "Hitch Guidance with Hitch View and Image Adjustment",
                                "msrp": 0
                            },
                            {
                                "sales_code": "QF9",
                                "description": "Tires: LT275/65 R20 All Terrain, Blackwall",
                                "msrp": 0
                            },
                            {
                                "sales_code": "QK1",
                                "description": "Standard Tailgate",
                                "msrp": 0
                            },
                            {
                                "sales_code": "QT6",
                                "description": "Tailgate Function--Power Up and Down",
                                "msrp": 0
                            },
                            {
                                "sales_code": "SNR",
                                "description": "Rear Seat: Folding w/ Deluxe Storage",
                                "msrp": 0
                            },
                            {
                                "sales_code": "SRI",
                                "description": "Wheels: 20\" Aluminum Black",
                                "msrp": 0
                            },
                            {
                                "sales_code": "T3U",
                                "description": "LED Fog Lamps, Front",
                                "msrp": 0
                            },
                            {
                                "sales_code": "TQ5",
                                "description": "Headlamps, Intellibeam",
                                "msrp": 0
                            },
                            {
                                "sales_code": "TRG",
                                "description": "Trailer Camera Provisions",
                                "msrp": 0
                            },
                            {
                                "sales_code": "U01",
                                "description": "Roof Marker Lamps",
                                "msrp": 0
                            },
                            {
                                "sales_code": "U2K",
                                "description": "SiriusXM Satellite Radio (subscription)",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UBC",
                                "description": "2-USBs, First Row Charge/Data Ports",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UBI",
                                "description": "2-USBs, Second Row Charge/Data Ports",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UD5",
                                "description": "Parking Assist, Front & Rear Sensors",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UE1",
                                "description": "OnStar Communication System",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UE4",
                                "description": "Following Distance Indicator",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UET",
                                "description": "Smart Trailer Indicator",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UEU",
                                "description": "Sensor, Forward Collision Alert",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UF2",
                                "description": "Lighting, Cargo Box, LED",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UG1",
                                "description": "Homelink Garage Door Opener",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UGA",
                                "description": "Red Recovery Hooks",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UHY",
                                "description": "Automatic Emergency Braking",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UK3",
                                "description": "Radio Controls - Steering Wheel",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UKJ",
                                "description": "Sensor, Front Pedestrian Braking",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UKV",
                                "description": "Trailer Side Blind Zone Alert",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UQA",
                                "description": "Speaker System: Bose Premium Sound System",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UTJ",
                                "description": "Theft Protection System, Unauthorized Entry",
                                "msrp": 0
                            },
                            {
                                "sales_code": "UVN",
                                "description": "Bed View Camera",
                                "msrp": 0
                            },
                            {
                                "sales_code": "VK3",
                                "description": "Front License Plate Mounting Provisions",
                                "msrp": 0
                            }
                        ],
                        "Destination Fees": [
                            {
                                "description": "Destination & Delivery",
                                "msrp": 0
                            }
                        ]
                    },
                    "summary": {
                        "total_base_and_options": 82435,
                        "discounts": "N/A",
                        "total_msrp": 82435
                    }
                }
            ],
        },
    ]
}

const optionsData = {
    "running_boards": [
        {
            "part_number": "T203",
            "description": "Automatic Power Deploying Running Boards Integrated LED Light System",
            "price": 2250
        },
        {
            "part_number": "T706",
            "description": "Black HDX Drop Step Bars",
            "price": 1000
        }
    ],
    "truck_bed_options": [
        {
            "part_number": "T213",
            "description": "Roll-up Tonneau Cover + Bed Protection Package",
            "price": 1075
        },
        {
            "part_number": "T214",
            "description": "Low Profile Soft Roll-up Tonneau Cover",
            "price": 625
        },
        {
            "part_number": "T215",
            "description": "Elite Painted Truck Cover - Colored Keyed & Bed Protection",
            "price": 2500
        }
    ],
    "exterior_options": [
        {
            "part_number": "T504",
            "description": "Front Custom Bumpers Black W/ LED Lights",
            "price": 4000
        }
    ],
    "paint_options": [
        {
            "part_number": "T225",
            "description": "Tuxedo Paint - Paint Top of Cab Black",
            "price": 3125
        }
    ],
    "interior_amenities": [
        {
            "part_number": "T300",
            "description": "Waldoch Black Leather w/ Grey Accents and Heat",
            "price": 2000
        },
        {
            "part_number": "T305",
            "description": "Window Tint (Legal by State Purchased In)",
            "price": 225
        }
    ],
    "performance_package": [
        {
            "part_number": "T400",
            "description": "Custom Performance Exhaust System",
            "price": 1250
        },
        {
            "part_number": "T401",
            "description": "Upgrade - Fox Shox 2.5 Remote Reservoir Coil-over",
            "price": 3125
        },
        {
            "part_number": "T403",
            "description": "Waldoch Super Charger - Call for pricing",
            "price": 16250
        }
    ],
    "wheels_and_tires": [
        {
            "part_number": "T505",
            "description": "Upgrade - All Terrain Tires",
            "price": 1250
        },
        {
            "part_number": "T511",
            "description": "Upgrade - 22\" Wheels & Tires",
            "price": 2500
        }
    ]
};

// helper functions
let showPrices = false;

function validateRequiredFields() {
    const form = document.querySelector('#vehicle-form');
    const chassisDropdown = document.querySelector('#chassis-dropdown');
    const requiredFields = [
        { name: 'first_name', label: 'First Name' },
        { name: 'last_name', label: 'Last Name' },
        { name: 'your_email', label: 'Email' },
        { name: 'phone', label: 'Phone' },
        { name: 'form_fields[country]', label: 'Country' },
        { name: 'form_fields[state]', label: 'State / Province' },
        { name: 'chassis-dropdown', label: 'Chassis' },
    ];

    const selectedChassis = chassisController.getSelectedChassis();
    if (selectedChassis) {
        const brand = getBrandForChassis(selectedChassis.part_number);
        if (brand) {
            requiredFields.push({
                name: `${brand.toLowerCase()}_exterior_paint`,
                label: 'Exterior Paint'
            });
        }
    }

    const missingFields = [];

    requiredFields.forEach(field => {
        if (field.name.includes('exterior_paint') || field.name === 'running_boards' || field.name === 'truck_bed_options' || field.name === 'wheels_tires') {
            const checked = form.querySelector(`input[name="${field.name}"]:checked`);
            if (!checked) {
                missingFields.push(field.label);
            }
        } else if (field.name === 'chassis-dropdown') {
            const inputValue = chassisDropdown ? chassisDropdown.value : '';
            const isValidChassis = inputValue && inputValue !== '' && selectedChassis;
            if (!isValidChassis) {
                missingFields.push(field.label);
            }
        } else {
            const input = form.querySelector(`[name="${field.name}"]`);
            if (!input || !input.value.trim()) {
                missingFields.push(field.label);
            }
        }
    });

    return missingFields;
}

// Create modals dynamically if they don't exist
function createModals() {
    const existingMissingModal = document.getElementById('missing-fields-modal');
    const existingConfirmModal = document.getElementById('confirm-submit-modal');

    if (!existingMissingModal) {
        const missingModal = document.createElement('div');
        missingModal.id = 'missing-fields-modal';
        missingModal.className = 'modal';
        missingModal.style.display = 'none';
        missingModal.innerHTML = `
      <div class="modal-content">
        <p>Please fill out the following required fields:</p>
        <ul id="missing-fields-list"></ul>
        <div class="modal-buttons">
          <button id="close-missing-modal">Close</button>
        </div>
      </div>
    `;
        document.body.appendChild(missingModal);
    }

    if (!existingConfirmModal) {
        const confirmModal = document.createElement('div');
        confirmModal.id = 'confirm-submit-modal';
        confirmModal.className = 'modal';
        confirmModal.style.display = 'none';
        confirmModal.innerHTML = `
      <div class="modal-content">
        <p>Are you sure you want to submit your configuration?</p>
        <div class="modal-buttons">
          <button id="confirm-submit-btn">Confirm</button>
          <button id="cancel-submit-btn">Cancel</button>
        </div>
      </div>
    `;
        document.body.appendChild(confirmModal);
    }

    // Add modal and table styles
    const style = document.createElement('style');
    style.textContent = `

  `;
    document.head.appendChild(style);
}

initializeForm(optionsData);

function initializeForm(optionsData) {
    const ramPaintCodes = chassisData.brands
        .filter(brand => brand.brand === 'Ram')
        .flatMap(brand => brand.chassis)
        .flatMap(chassis => chassis.categories["Exterior_Paint"] || [])
        .map(paint => paint.sales_code);

    const filteredPaintOptions = optionsData.paint_options.filter(
        item => !ramPaintCodes.includes(item.part_number)
    );

    renderCategory('running_boards', optionsData.running_boards, 'running_boards', true);
    renderCategory('truck_bed_options', optionsData.truck_bed_options, 'truck_bed_options', true);
    renderCategory('exterior_options', optionsData.exterior_options, 'exterior_options', false);
    renderCategory('paint_options', filteredPaintOptions, 'paint_options', false);
    renderCategory('interior_amenities', optionsData.interior_amenities, 'interior_amenities', false);
    renderCategory('performance_package', optionsData.performance_package, 'performance_package', false);
    renderCategory('wheels_and_tires', optionsData.wheels_and_tires, 'wheels_tires', true);
}

function initChassisSelection(vehicles) {
    const chassisDropdown = document.getElementById('chassis-dropdown');
    const summaryBody = document.getElementById('summary-body');
    const toggleBtn = document.getElementById('toggle-chassis-info');
    const chassisTable = document.getElementById('chassis-details');
    const expandBtn = document.getElementById('expand-collapse-btn');

    let selectedChassis = null;

    function clearSummaryChassisRow() {
        const rows = summaryBody.querySelectorAll('tr');
        rows.forEach(row => {
            if (row.dataset.category === 'chassis') {
                row.remove();
            }
        });
    }

    function addSummaryChassisRow(partNumber, modelName, price) {
        const chassisRow = document.createElement('tr');
        chassisRow.dataset.category = 'chassis';
        chassisRow.dataset.price = price;
        chassisRow.innerHTML = `
      <td>Chassis</td>
      <td>${partNumber}</td>
      <td>${modelName}</td>
      ${showPrices ? `<td class="price-cell">$${price.toLocaleString()}</td>` : ''}
    `;
        summaryBody.prepend(chassisRow);
    }

    function onChassisChange(value, updateSummaryTable = true) {
        const [brandKey, partNumber] = value.split('-');
        const brandData = vehicles.find(v => v.brand.toLowerCase() === brandKey.toLowerCase());

        if (!brandData) {
            if (updateSummaryTable) clearSummaryChassisRow();
            selectedChassis = null;
            toggleBtn.style.display = 'none';
            chassisTable.style.display = 'none';
            expandBtn.style.display = 'none';
            chassisTable.classList.remove('scrollable', 'expanded');
            return;
        }

        const chassis = brandData.chassis.find(c => c.part_number === partNumber);

        let chassisInfoBody = document.getElementById('chassis-info-body');

        if (!chassis) {
            if (chassisInfoBody) chassisInfoBody.innerHTML = '';
            if (updateSummaryTable) clearSummaryChassisRow();
            selectedChassis = null;
            toggleBtn.style.display = 'none';
            chassisTable.style.display = 'none';
            expandBtn.style.display = 'none';
            chassisTable.classList.remove('scrollable', 'expanded');
            return;
        }

        const chassisTableEl = document.getElementById('chassis-details');
        chassisTableEl.innerHTML = `
      <thead>
        <tr>
          <th>Category</th>
          <th>Sales Code</th>
          <th>Description</th>
          ${showPrices ? '<th>Price</th>' : ''}
        </tr>
      </thead>
      <tbody id="chassis-info-body"></tbody>
    `;

        chassisInfoBody = document.getElementById('chassis-info-body');

        for (const [category, items] of Object.entries(chassis.categories)) {
            if (category === 'Exterior_Paint') continue;

            items.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
          <td>${category}</td>
          <td>${item.sales_code || ''}</td>
          <td>${item.description}</td>
          ${showPrices ? `<td class="price-cell">$${item.msrp.toLocaleString()}</td>` : ''}
        `;
                chassisInfoBody.appendChild(row);
            });
        }

        if (updateSummaryTable) {
            clearSummaryChassisRow();
            addSummaryChassisRow(chassis.part_number, chassis.model, chassis.price);
        }

        selectedChassis = chassis;
        toggleBtn.style.display = 'inline-block';
        toggleBtn.textContent = 'Hide Information';
        chassisTable.style.display = 'table';
        chassisTable.classList.add('scrollable');
        chassisTable.classList.remove('expanded');
        expandBtn.style.display = 'inline-block';
        expandBtn.textContent = 'Expand Table';
    }

    chassisDropdown.addEventListener('change', (e) => {
        onChassisChange(e.target.value);
        document.dispatchEvent(new CustomEvent('chassisChanged'));
    });

    document.addEventListener('DOMContentLoaded', () => {
        if (!chassisDropdown || !summaryBody || !toggleBtn || !chassisTable || !expandBtn) {
            console.error('One or more chassis selection elements not found:', {
                chassisDropdown, summaryBody, toggleBtn, chassisTable, expandBtn
            });
            return;
        }

        toggleBtn.style.display = 'none';
        chassisTable.style.display = 'none';
        expandBtn.style.display = 'none';
        chassisTable.classList.remove('scrollable', 'expanded');

        toggleBtn.addEventListener('click', () => {
            const isHidden = chassisTable.style.display === 'none';
            chassisTable.style.display = isHidden ? 'table' : 'none';
            toggleBtn.textContent = isHidden ? 'Hide Information' : 'Show Information';
            expandBtn.style.display = isHidden ? 'inline-block' : 'none';
            if (isHidden) {
                chassisTable.classList.add('scrollable');
                chassisTable.classList.remove('expanded');
                expandBtn.textContent = 'Expand Table';
            }
        });

        expandBtn.addEventListener('click', () => {
            if (chassisTable.classList.contains('scrollable')) {
                chassisTable.classList.remove('scrollable');
                chassisTable.classList.add('expanded');
                expandBtn.textContent = 'Collapse Table';
            } else {
                chassisTable.classList.add('scrollable');
                chassisTable.classList.remove('expanded');
                expandBtn.textContent = 'Expand Table';
            }
        });

        chassisDropdown.addEventListener('change', () => {
            if (chassisDropdown.value) {
                toggleBtn.style.display = 'inline-block';
                toggleBtn.textContent = 'Hide Information';
                chassisTable.style.display = 'table';
                chassisTable.classList.add('scrollable');
                chassisTable.classList.remove('expanded');
                expandBtn.style.display = 'inline-block';
                expandBtn.textContent = 'Expand Table';
            } else {
                toggleBtn.style.display = 'none';
                chassisTable.style.display = 'none';
                expandBtn.style.display = 'none';
                chassisTable.classList.remove('scrollable', 'expanded');
            }
        });
    });

    return {
        getSelectedChassis() {
            return selectedChassis;
        },
        selectChassis(value) {
            chassisDropdown.value = value;
            onChassisChange(value);
            document.dispatchEvent(new CustomEvent('chassisChanged'));
        },
        onChassisChange
    };
}

const chassisController = initChassisSelection(chassisData.brands);
const form = document.querySelector('#vehicle-form');
form.addEventListener('submit', handleFormSubmit);

function setupGalaxyInfoToggle() {
    const toggleBtn = document.getElementById("toggle-galaxy-info");
    const expandBtn = document.getElementById("expand-galaxy-btn");
    const galaxyInfo = document.getElementById("galaxy-standard-features");

    if (!toggleBtn || !expandBtn || !galaxyInfo) {
        console.error('One or more galaxy info elements not found:', {
            toggleBtn, expandBtn, galaxyInfo
        });
        return;
    }

    // Initialize to visible and scrollable (collapsed)
    galaxyInfo.style.display = 'block'; // Use block instead of table for div
    galaxyInfo.classList.add('scrollable');
    galaxyInfo.classList.remove('expanded');
    toggleBtn.textContent = 'Hide Information';
    expandBtn.style.display = 'inline-block';
    expandBtn.textContent = 'Expand Table';

    // Clear existing listeners to prevent duplicates
    toggleBtn.replaceWith(toggleBtn.cloneNode(true));
    expandBtn.replaceWith(expandBtn.cloneNode(true));

    // Re-select elements after cloning
    const newToggleBtn = document.getElementById("toggle-galaxy-info");
    const newExpandBtn = document.getElementById("expand-galaxy-btn");

    newToggleBtn.addEventListener('click', () => {
        const isHidden = galaxyInfo.style.display === 'none';
        galaxyInfo.style.display = isHidden ? 'block' : 'none';
        newToggleBtn.textContent = isHidden ? 'Hide Information' : 'Show Information';
        newExpandBtn.style.display = isHidden ? 'inline-block' : 'none';
        if (isHidden) {
            galaxyInfo.classList.add('scrollable');
            galaxyInfo.classList.remove('expanded');
            newExpandBtn.textContent = 'Expand Table';
        }
    });

    newExpandBtn.addEventListener('click', () => {
        if (galaxyInfo.classList.contains('scrollable')) {
            galaxyInfo.classList.remove('scrollable');
            galaxyInfo.classList.add('expanded');
            newExpandBtn.textContent = 'Collapse Table';
        } else {
            galaxyInfo.classList.add('scrollable');
            galaxyInfo.classList.remove('expanded');
            newExpandBtn.textContent = 'Expand Table';
        }
    });
}

function updateSummary() {
    const form = document.querySelector('#vehicle-form');
    const summaryBody = document.querySelector('#summary-body');
    const totalDisplay = document.querySelector('#total-price');
    const summaryTable = document.querySelector('#selection-summary table');
    const includedPartNumbers = new Set();

    let totalPrice = 0;
    summaryBody.innerHTML = '';

    if (summaryTable) {
        const thead = summaryTable.querySelector('thead tr') || summaryTable.querySelector('thead').appendChild(document.createElement('tr'));
        thead.innerHTML = `
      <th>Category</th>
      <th>Part Number</th>
      <th>Description</th>
      ${showPrices ? '<th>Price</th>' : ''}
    `;
    }

    const BASE_PRICE = 15000;
    const FREIGHT_PRICE = 0;

    addSummaryRow("Base Price", "Fixed Base Price", "BASE", BASE_PRICE);
    totalPrice += BASE_PRICE;

    addSummaryRow("Freight", "Freight Charge", "FREIGHT", FREIGHT_PRICE);
    totalPrice += FREIGHT_PRICE;

    const selectedChassis = chassisController.getSelectedChassis();
    if (selectedChassis) {
        addSummaryRow("Chassis", selectedChassis.model, selectedChassis.part_number, selectedChassis.price);
        totalPrice += selectedChassis.price;
    }

    ['ram_exterior_paint', 'ford_exterior_paint', 'chevrolet_exterior_paint'].forEach(paintField => {
        const selectedPaint = document.querySelector(`input[name="${paintField}"]:checked`);
        if (selectedPaint) {
            const price = parseFloat(selectedPaint.dataset.price || 0);
            addSummaryRow("Exterior Paint", selectedPaint.dataset.partName, selectedPaint.dataset.partNumber, price);
            totalPrice += price;
        }
    });

    function processCheckboxGroup(name, label) {
        const selectedItems = form.querySelectorAll(`input[name="${name}"]:checked`);
        selectedItems.forEach(item => {
            if (includedPartNumbers.has(item.value)) return;
            const price = parseFloat(item.dataset.price || 0);
            totalPrice += price;
            addSummaryRow(label, item.dataset.partName || item.value, item.dataset.partNumber || item.value, price);
            includedPartNumbers.add(item.value);
        });
    }

    processCheckboxGroup("running_boards", "Running Boards");
    processCheckboxGroup("truck_bed_options", "Truck Bed Options");
    processCheckboxGroup("exterior_options", "Exterior Options");
    processCheckboxGroup("paint_options", "Paint Options");
    processCheckboxGroup("interior_amenities", "Interior Options");
    processCheckboxGroup("performance_package", "Performance Package");

    const wheels = form.querySelector('input[name="wheels_tires"]:checked');
    if (wheels && !includedPartNumbers.has(wheels.value)) {
        const price = parseFloat(wheels.dataset.price || 0);
        totalPrice += price;
        addSummaryRow("Wheels and Tires", wheels.dataset.partName || wheels.value, wheels.dataset.partNumber || wheels.value, price);
        includedPartNumbers.add(wheels.value);
    }

    totalDisplay.dataset.totalPrice = totalPrice;
    totalDisplay.textContent = showPrices ? `Total: $${totalPrice.toFixed(2)}` : '';
}

function renderCategory(label, items, inputName, isSingleSelect) {
    const form = document.querySelector('#vehicle-form');
    const fieldset = document.createElement('fieldset');
    const legend = document.createElement('legend');
    legend.textContent = label.replace(/_/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
    fieldset.appendChild(legend);

    const wrapper = document.createElement('div');
    wrapper.className = isSingleSelect ? 'radio-group' : 'checkbox-group';

    items.forEach(item => {
        const input = document.createElement('input');
        input.type = isSingleSelect ? 'radio' : 'checkbox';
        input.name = inputName;
        input.id = item.part_number;
        input.value = item.part_number;
        input.dataset.price = item.price;
        input.dataset.partName = item.description;
        input.dataset.partNumber = item.part_number;

        input.addEventListener('change', () => {
            updateSummary();
        });

        const label = document.createElement('label');
        label.htmlFor = item.part_number;
        label.textContent = item.description;

        const optionRow = document.createElement('div');
        optionRow.className = 'option-row';
        optionRow.appendChild(label);
        optionRow.appendChild(input);

        wrapper.appendChild(optionRow);
    });

    const containerDiv = document.createElement('div');
    containerDiv.className = 'category-container';
    containerDiv.id = inputName === 'wheels_tires' ? 'wheels-tires-container' : '';
    containerDiv.appendChild(wrapper);

    fieldset.appendChild(containerDiv);
    form.insertBefore(fieldset, form.querySelector('button[type="submit"]'));
}

function addSummaryRow(category, name, partNumber, price, highlightNegative = false) {
    const summaryBody = document.querySelector('#summary-body');
    const priceCellStyle = highlightNegative && price < 0 ? 'style="color: red;"' : '';
    summaryBody.insertAdjacentHTML('beforeend', `
    <tr>
      <td>${category}</td>
      <td>${partNumber}</td>
      <td>${name}</td>
      ${showPrices ? `<td class="price-cell" data-price="${price}" ${priceCellStyle}>$${price.toLocaleString()}</td>` : ''}
    </tr>
  `);
}

function getBrandForChassis(partNumber) {
    for (const brand of chassisData.brands) {
        if (brand.chassis.some(c => c.part_number === partNumber)) {
            return brand.brand;
        }
    }
    return null;
}

function renderExteriorPaintPicker(brandName, brands, selectedPartNumber) {
    const brand = brands.find(b => b.brand === brandName);
    if (!brand) return;

    const selectedChassis = brand.chassis.find(c => c.part_number === selectedPartNumber);
    if (!selectedChassis) return;

    const paintOptions = selectedChassis.categories["Exterior_Paint"] || [];
    const container = document.getElementById('exterior-paint-picker');
    container.innerHTML = '';

    const grid = document.createElement('div');
    grid.className = 'paint-picker-grid';

    paintOptions.forEach(option => {
        const card = document.createElement('div');
        card.className = 'paint-card';

        const checkbox = document.createElement('input');
        checkbox.type = 'radio';
        checkbox.required = true;
        checkbox.name = `${brandName.toLowerCase()}_exterior_paint`;
        const salesCode = option.sales_code || option.description.toLowerCase().replace(/\s+/g, '-');
        checkbox.value = salesCode;
        checkbox.dataset.price = option.msrp;
        checkbox.dataset.partName = option.description;
        checkbox.dataset.partNumber = salesCode;
        checkbox.id = `${brandName.toLowerCase()}-${salesCode}`;

        checkbox.addEventListener('change', () => {
            document.querySelectorAll(`input[name="${checkbox.name}"]`).forEach(cb => {
                if (cb !== checkbox) cb.checked = false;
            });
            updateSummary();
        });

        const label = document.createElement('label');
        label.setAttribute('for', checkbox.id);
        label.className = 'paint-label';

        if (brandName === 'Ram' || brandName === 'Chevrolet') {
            const swatchImg = document.createElement('img');
            swatchImg.src = option.image;
            swatchImg.alt = option.description;
            swatchImg.className = 'paint-swatch-image';
            swatchImg.style.width = '80px';
            swatchImg.style.height = 'auto';
            label.appendChild(swatchImg);
        } else if (brandName === 'Ford') {
            const swatch = document.createElement('div');
            swatch.className = 'paint-swatch';
            swatch.style.backgroundColor = option.background_color;
            swatch.title = option.description;
            label.appendChild(swatch);
        }

        label.appendChild(document.createTextNode(option.description));

        card.appendChild(checkbox);
        card.appendChild(label);
        grid.appendChild(card);
    });

    container.appendChild(grid);
}

async function submitForm() {
    const form = document.querySelector('#vehicle-form');
    const totalDisplay = document.querySelector('#total-price');
    const selectedChassis = chassisController.getSelectedChassis();

    const collectValues = name =>
        Array.from(form.querySelectorAll(`input[name="${name}"]:checked`)).map(i => ({
            part_number: i.value,
            description: i.dataset.partName || i.value,
            price: parseFloat(i.dataset.price) || 0
        }));

    let totalPrice = 0;
    const BASE_PRICE = 15000;
    const FREIGHT_PRICE = 0;
    totalPrice += BASE_PRICE + FREIGHT_PRICE;

    if (selectedChassis) {
        totalPrice += selectedChassis.price || 0;
    }

    ['ram_exterior_paint', 'ford_exterior_paint', 'chevrolet_exterior_paint'].forEach(paintField => {
        const selectedPaint = document.querySelector(`input[name="${paintField}"]:checked`);
        if (selectedPaint) {
            totalPrice += parseFloat(selectedPaint.dataset.price) || 0;
        }
    });

    const optionFields = [
        'running_boards',
        'truck_bed_options',
        'exterior_options',
        'paint_options',
        'interior_amenities',
        'performance_package',
        'wheels_tires',
        'electronics'
    ];

    const includedPartNumbers = new Set();
    optionFields.forEach(field => {
        const selectedItems = form.querySelectorAll(`input[name="${field}"]:checked`);
        selectedItems.forEach(item => {
            if (!includedPartNumbers.has(item.value)) {
                totalPrice += parseFloat(item.dataset.price) || 0;
                includedPartNumbers.add(item.value);
            }
        });
    });

    const vehicleConfig = {
        customer_info: {
            first_name: form.querySelector('[name="first_name"]').value || '',
            last_name: form.querySelector('[name="last_name"]').value || '',
            email: form.querySelector('[name="your_email"]').value || '',
            phone: form.querySelector('[name="phone"]').value || '',
            address: form.querySelector('[name="address"]').value || '',
            city: form.querySelector('[name="city"]').value || '',
            country: form.querySelector('[name="form_fields[country]"]').value || '',
            state_province: form.querySelector('[name="form_fields[state]"]').value || '',
            zip: form.querySelector('[name="zip"]').value || '',
            contact_preference: collectValues('contact_preference').map(item => item.description),
            purchase_timeline: form.querySelector('[name="purchase_timeline"]').value || '',
            dealer: form.querySelector('[name="dealer"]').value || '',
            comments: form.querySelector('[name="comments"]').value || '',
            special_offers: form.querySelector('input[name="special_offers"]:checked')?.value === 'yes' ? 'Yes' : 'No',
        },
        chassis: selectedChassis
            ? {
                part_number: selectedChassis.part_number,
                description: selectedChassis.model,
            }
            : null,
        exterior_paint: (() => {
            const paintFields = ['ram_exterior_paint', 'ford_exterior_paint', 'chevrolet_exterior_paint'];
            for (const field of paintFields) {
                const selected = document.querySelector(`input[name="${field}"]:checked`);
                if (selected) {
                    return {
                        part_number: selected.dataset.partNumber || selected.value,
                        description: selected.dataset.partName || '',
                    };
                }
            }
            return null;
        })(),
        running_boards: collectValues('running_boards'),
        truck_bed_options: collectValues('truck_bed_options'),
        exterior_options: collectValues('exterior_options'),
        paint_options: collectValues('paint_options'),
        interior_amenities: collectValues('interior_amenities'),
        performance_package: collectValues('performance_package'),
        wheels_tires: (() => {
            const input = form.querySelector('input[name="wheels_tires"]:checked');
            return input ? {
                part_number: input.value,
                description: input.dataset.partName || '',
            } : null;
        })(),
        electronics: collectValues('electronics'),
        total_price: totalPrice,
    };

    console.log('Configuration:', vehicleConfig);

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    async function loadImage(url) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            img.crossOrigin = 'Anonymous';
            img.onload = () => {
                const canvas = document.createElement('canvas');
                canvas.width = img.width;
                canvas.height = img.height;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0);
                resolve(canvas.toDataURL('image/png'));
            };
            img.onerror = reject;
            img.src = url;
        });
    }

    try {
        const logoUrl = 'https://www.waldoch.com/wp-content/uploads//2025/08/waldoch-logo-black2_1.png';
        const logoData = await loadImage(logoUrl);
        doc.addImage(logoData, 'PNG', 10, 5, 50, 14);
    } catch (error) {
        console.error('Failed to load logo:', error);
    }

    try {
        const warrantyLogoUrl = 'https://www.waldoch.com/wp-content/uploads/2021/02/warranty-logo.png';
        const warrantyLogoData = await loadImage(warrantyLogoUrl);
        doc.addImage(warrantyLogoData, 'PNG', 160, 5, 40, 16.5);
    } catch (error) {
        console.error('Failed to load warranty logo:', error);
    }

    doc.setFontSize(14);
    doc.setFont(undefined, 'bold');
    doc.text("Rampage HD Vehicle Configuration", 105, 15, { align: 'center' });
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');

    doc.setFontSize(11);
    doc.setFont(undefined, 'bold');
    let y = 30;
    doc.text("Customer Information", 10, y);
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    doc.text(`Date: ${new Date().toLocaleDateString()}`, 190, y, { align: 'right' });
    doc.setLineWidth(0.2);
    doc.line(10, y + 2, 200, y + 2);
    y += 5;
    doc.setFontSize(8);
    doc.setFont(undefined, 'normal');

    const customerInfo = vehicleConfig.customer_info;
    const leftColumnX = 10;
    const rightColumnX = 105;
    let leftY = y;
    let rightY = y;

    doc.text(`Name: ${customerInfo.first_name} ${customerInfo.last_name}`.trim(), leftColumnX, leftY);
    leftY += 4;
    doc.text(`Email: ${customerInfo.email}`, leftColumnX, leftY);
    leftY += 4;
    doc.text(`Phone: ${customerInfo.phone}`, leftColumnX, leftY);
    leftY += 4;
    doc.text(`Address: ${customerInfo.address}`, leftColumnX, leftY);
    leftY += 4;
    doc.text(`City: ${customerInfo.city}`, leftColumnX, leftY);
    leftY += 4;
    doc.text(`State: ${customerInfo.state_province}`, leftColumnX, leftY);
    leftY += 4;
    doc.text(`Country: ${customerInfo.country}`, leftColumnX, leftY);
    leftY += 4;

    doc.text(`Zip: ${customerInfo.zip}`, rightColumnX, rightY);
    rightY += 4;
    doc.text(`Contact Preference: ${customerInfo.contact_preference.length > 0 ? customerInfo.contact_preference.join(', ') : ''}`, rightColumnX, rightY);
    rightY += 4;
    doc.text(`Purchase Timeline: ${customerInfo.purchase_timeline}`, rightColumnX, rightY);
    rightY += 4;
    doc.text(`Dealer: ${customerInfo.dealer}`, rightColumnX, rightY);
    rightY += 4;
    doc.text(`Special Offers: ${customerInfo.special_offers}`, rightColumnX, rightY);
    rightY += 4;
    const wrappedComments = doc.splitTextToSize(`Comments: ${customerInfo.comments}`, 90);
    for (let i = 0; i < wrappedComments.length; i++) {
        doc.text(wrappedComments[i], rightColumnX, rightY + (i * 4));
    }
    rightY += wrappedComments.length * 4;

    y = Math.max(leftY, rightY) + 5;

    doc.setLineWidth(0.5);
    doc.line(10, y, 200, y);
    y += 5;

    doc.setFontSize(10);
    doc.setFont(undefined, 'bold');
    doc.text("Part Number", 10, y);
    doc.text("Description", 35, y);
    doc.text("Part Number", 100, y);
    doc.text("Description", 125, y);
    doc.setLineWidth(0.2);
    doc.line(10, y + 2, 200, y + 2);
    y += 5;
    doc.setFontSize(8);
    doc.setFont(undefined, 'normal');

    function addTableRow(leftItem, rightItem) {
        const maxDescWidth = 60;
        const leftPartNumber = leftItem ? (leftItem.part_number || 'N/A') : '';
        const leftDesc = leftItem ? (leftItem.description || 'None') : '';
        const rightPartNumber = rightItem ? (rightItem.part_number || 'N/A') : '';
        const rightDesc = rightItem ? (rightItem.description || 'None') : '';

        const leftWrappedDesc = doc.splitTextToSize(leftDesc, maxDescWidth);
        const rightWrappedDesc = doc.splitTextToSize(rightDesc, maxDescWidth);
        const maxLines = Math.max(leftWrappedDesc.length, rightWrappedDesc.length, 1);

        if (leftItem) {
            doc.text(leftPartNumber, 10, y);
            for (let i = 0; i < leftWrappedDesc.length; i++) {
                doc.text(leftWrappedDesc[i], 30, y + (i * 4));
            }
        }

        if (rightItem) {
            doc.text(rightPartNumber, 100, y);
            for (let i = 0; i < rightWrappedDesc.length; i++) {
                doc.text(rightWrappedDesc[i], 120, y + (i * 4));
            }
        }

        if (leftItem || rightItem) {
            doc.setLineWidth(0.2);
            doc.line(95, y - 2, 95, y + Math.max(maxLines * 4, 5) - 2);
        }

        y += Math.max(maxLines * 4, 5);
    }

    function printSection(title, content) {
        if (content === null || (Array.isArray(content) && content.length === 0)) {
            return;
        }
        if (typeof content === 'object' && !Array.isArray(content) && content.part_number === 'N/A' && content.description === 'None') {
            return;
        }
        if (Array.isArray(content) && content.every(item => item.part_number === 'N/A' && item.description === 'None')) {
            return;
        }
        if (typeof content === 'string' && content === 'None') {
            return;
        }

        doc.setFont(undefined, 'bold');
        doc.text(title, 10, y);
        y += 5;
        doc.setFont(undefined, 'normal');

        if (typeof content === 'object' && !Array.isArray(content) && content !== null) {
            addTableRow(content, null);
        } else if (Array.isArray(content)) {
            for (let i = 0; i < content.length; i += 2) {
                const leftItem = content[i];
                const rightItem = i + 1 < content.length ? content[i + 1] : null;
                addTableRow(leftItem, rightItem);
            }
        } else if (content != null) {
            addTableRow({ part_number: null, description: content }, null);
        }

        y += 2;
    }

    printSection("Chassis", vehicleConfig.chassis);
    printSection("Exterior Paint", vehicleConfig.exterior_paint);
    printSection("Running Boards", vehicleConfig.running_boards);
    printSection("Truck Bed Options", vehicleConfig.truck_bed_options);
    printSection("Exterior Options", vehicleConfig.exterior_options);
    printSection("Paint Options", vehicleConfig.paint_options);
    printSection("Interior Amenities", vehicleConfig.interior_amenities);
    printSection("Performance Package", vehicleConfig.performance_package);
    printSection("Wheels & Tires", vehicleConfig.wheels_tires);

    y += 5;
    doc.setLineWidth(0.5);
    doc.line(10, y, 200, y);
    y += 5;
    doc.setFont(undefined, 'bold');
    doc.text("Total Price", 10, y);
    doc.text(`$${vehicleConfig.total_price.toLocaleString()}`, 190, y, { align: 'right' });
    y += 12;

    doc.setFontSize(8);
    doc.setFont(undefined, 'normal');
    doc.text("Print Name:", 10, y);
    doc.line(35, y, 94.5, y);
    doc.text("Dealer Signature:", 105, y);
    doc.line(140, y, 199.5, y);

    const pdfBlob = doc.output('blob');
    const url = URL.createObjectURL(pdfBlob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${vehicleConfig.customer_info.first_name}_${vehicleConfig.customer_info.last_name}_RampageHD_Build.pdf`;
    a.click();
    URL.revokeObjectURL(url);

    const formData = new FormData();
    formData.append('first_name', vehicleConfig.customer_info.first_name);
    formData.append('last_name', vehicleConfig.customer_info.last_name);
    formData.append('email', vehicleConfig.customer_info.email);
    formData.append('phone', vehicleConfig.customer_info.phone);
    formData.append('address', vehicleConfig.customer_info.address);
    formData.append('city', vehicleConfig.customer_info.city);
    formData.append('form_fields[country]', vehicleConfig.customer_info.country);
    formData.append('form_fields[state]', vehicleConfig.customer_info.state_province);
    formData.append('zip', vehicleConfig.customer_info.zip);
    vehicleConfig.customer_info.contact_preference.forEach((value, index) => {
        formData.append(`contact_preference[${index}]`, value);
    });
    formData.append('purchase_timeline', vehicleConfig.customer_info.purchase_timeline);
    formData.append('dealer', vehicleConfig.customer_info.dealer);
    formData.append('comments', vehicleConfig.customer_info.comments);
    formData.append('special_offers', vehicleConfig.customer_info.special_offers);

    let vehicle_make = '';
    if (vehicleConfig.chassis && vehicleConfig.chassis.part_number) {
        const selectedChassis = chassisData.brands.find(brand =>
            brand.chassis.some(chassis => chassis.part_number === vehicleConfig.chassis.part_number)
        );
        vehicle_make = selectedChassis ? selectedChassis.brand : '';
    }

    formData.append('vehicle_make', vehicle_make);
    formData.append('vehicle_type', 'Trucks');
    formData.append('vehicle_package', 'Rampage HD');

    const pdfFile = new File([pdfBlob], `${vehicleConfig.customer_info.first_name}_${vehicleConfig.customer_info.last_name}_RampageHD_Build.pdf`, { type: 'application/pdf' });
    formData.append('pdf', pdfFile);

    // Convert pdfBlob to Base64
    const base64Content = await new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => {
            const base64String = reader.result.split(',')[1]; // Extract Base64 part
            if (!base64String) {
                reject(new Error('Failed to convert PDF to Base64'));
            } else {
                resolve(base64String);
            }
        };
        reader.onerror = () => reject(new Error('Error reading PDF blob'));
        reader.readAsDataURL(pdfBlob);
    });

    console.log('FormData contents:');
    for (const [key, value] of formData.entries()) {
        console.log(`${key}:`, value instanceof File ? `File(${value.name})` : value);
    }

    const expressPayload = {
        first_name: vehicleConfig.customer_info.first_name,
        last_name: vehicleConfig.customer_info.last_name,
        email: vehicleConfig.customer_info.email,
        phone: vehicleConfig.customer_info.phone,
        address: vehicleConfig.customer_info.address,
        city: vehicleConfig.customer_info.city,
        state: vehicleConfig.customer_info.state_province,
        country: vehicleConfig.customer_info.country,
        zip: vehicleConfig.customer_info.zip,
        message: vehicleConfig.customer_info.comments, // Map comments to message
        file: {
            name: pdfFile.name,
            // Base64-encoded PDF
            content: base64Content
        }
    };

    try {
        // const response = await fetch('/wp-json/vehicle-config/v1/mailer', {
        //     method: 'POST',
        //     body: formData
        // });

        // if (!response.ok) {
        //     const err = await response.json();
        //     throw new Error(err.error || 'Unknown error occurred');
        // }

        // const data = await response.json();
        // console.log('Email sent successfully!', data.status);

        // Express server request (new)
        const expressResponse = await fetch('https://custom-shopify.onrender.com/api/builder', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(expressPayload)
        });

        if (!expressResponse.ok) {
            const err = await expressResponse.json();
            throw new Error(`Express server error: ${err.error || 'Unknown error'}`);
        }

        const expressData = await expressResponse.json();
        console.log('Express submission successful:', expressData);
        alert('Configuration saved successfully!');
        updateSummary();
    } catch (error) {
        console.error('Error sending PDF:', error.message);
        alert('Failed to save configuration: ' + error.message);
    }
}

function handleFormSubmit(e) {
    e.preventDefault();

    const form = document.querySelector('#vehicle-form');
    const missingFieldsModal = document.getElementById('missing-fields-modal');
    const confirmModal = document.getElementById('confirm-submit-modal');
    const missingFieldsList = document.getElementById('missing-fields-list');
    const closeMissingModalBtn = document.getElementById('close-missing-modal');
    const confirmSubmitBtn = document.getElementById('confirm-submit-btn');
    const cancelSubmitBtn = document.getElementById('cancel-submit-btn');

    if (!form || !missingFieldsModal || !confirmModal || !missingFieldsList || !closeMissingModalBtn || !confirmSubmitBtn || !cancelSubmitBtn) {
        console.error('One or more critical elements not found:', {
            form, missingFieldsModal, confirmModal, missingFieldsList, closeMissingModalBtn, confirmSubmitBtn, cancelSubmitBtn
        });
        alert('An error occurred. Please try again or contact support.');
        return;
    }

    const missingFields = validateRequiredFields();
    if (missingFields.length > 0) {
        missingFieldsList.innerHTML = missingFields.map(field => `<li>${field}</li>`).join('');
        missingFieldsModal.style.display = 'flex';
        closeMissingModalBtn.focus();

        closeMissingModalBtn.onclick = null;
        missingFieldsModal.onclick = null;

        closeMissingModalBtn.addEventListener('click', () => {
            missingFieldsModal.style.display = 'none';
        });

        missingFieldsModal.addEventListener('click', (event) => {
            if (event.target === missingFieldsModal) {
                missingFieldsModal.style.display = 'none';
            }
        });
        return;
    }

    confirmModal.style.display = 'flex';
    confirmSubmitBtn.focus();

    confirmSubmitBtn.onclick = null;
    cancelSubmitBtn.onclick = null;
    confirmModal.onclick = null;

    cancelSubmitBtn.addEventListener('click', () => {
        confirmModal.style.display = 'none';
    });

    confirmSubmitBtn.addEventListener('click', () => {
        confirmModal.style.display = 'none';
        showPrices = true;
        updateSummary();
        submitForm();
    });

    confirmModal.addEventListener('click', (event) => {
        if (event.target === confirmModal) {
            confirmModal.style.display = 'none';
        }
    });
}

document.addEventListener('chassisChanged', () => {
    const selectedChassis = chassisController.getSelectedChassis();
    const paintPicker = document.getElementById('exterior-paint-picker');
    const brand = getBrandForChassis(selectedChassis?.part_number);

    if (!selectedChassis) {
        paintPicker.innerHTML = '';
        return;
    }

    if (selectedChassis.part_number.startsWith('DJ')) {
        renderExteriorPaintPicker('Ram', chassisData.brands, selectedChassis.part_number);
    } else if (brand === 'Ford') {
        renderExteriorPaintPicker('Ford', chassisData.brands, selectedChassis.part_number);
    } else if (brand === 'Chevrolet') {
        renderExteriorPaintPicker('Chevrolet', chassisData.brands, selectedChassis.part_number);
    } else {
        paintPicker.innerHTML = '';
    }

    updateSummary();
});

document.addEventListener('DOMContentLoaded', () => {
    const form = document.querySelector('#vehicle-form');
    const saveConfigBtn = document.querySelector('#save-config-btn');
    const countrySelect = document.querySelector('#country');
    const stateSelect = document.querySelector('#state_province');

    if (!form) {
        console.error('Form (#vehicle-form) not found in DOM');
        return;
    }

    if (!saveConfigBtn) {
        console.error('Save Configuration button (#save-config-btn) not found in DOM');
        return;
    }

    if (!countrySelect) {
        console.error('Country select (#country) not found in DOM');
        return;
    }

    if (!stateSelect) {
        console.error('State select (#state_province) not found in DOM');
        return;
    }

    // Create modals
    createModals();

    // Ensure button is visible
    saveConfigBtn.style.display = 'inline-block';

    // Attach click listener to the save-config-btn
    saveConfigBtn.removeEventListener('click', handleFormSubmit);
    saveConfigBtn.addEventListener('click', handleFormSubmit);

    setupGalaxyInfoToggle();
    updateSummary();

    const usStates = [
        'Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware',
        'District of Columbia', 'Florida', 'Georgia', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa',
        'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota',
        'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire', 'New Jersey',
        'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon',
        'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah',
        'Vermont', 'Virginia', 'Washington', 'West Virginia', 'Wisconsin', 'Wyoming'
    ];

    const canadaProvinces = [
        'Alberta', 'British Columbia', 'Manitoba', 'New Brunswick', 'Newfoundland and Labrador',
        'Nova Scotia', 'Northwest Territories', 'Nunavut', 'Ontario', 'Prince Edward Island',
        'Quebec', 'Saskatchewan', 'Yukon'
    ];

    function updateStateOptions() {
        stateSelect.innerHTML = '<option value="">Select a state/province</option>';
        let options = [];
        if (countrySelect.value === 'United States') {
            options = usStates.map(state => `<option value="${state}">${state}</option>`);
        } else if (countrySelect.value === 'Canada') {
            options = canadaProvinces.map(province => `<option value="${province}">${province}</option>`);
        } else {
            options = ['<option value="Other">Other</option>'];
        }
        stateSelect.innerHTML += options.join('');
    }

    countrySelect.removeEventListener('change', updateStateOptions);
    countrySelect.addEventListener('change', updateStateOptions);

    updateStateOptions();
});